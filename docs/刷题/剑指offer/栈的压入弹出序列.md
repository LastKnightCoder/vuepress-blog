---
title: 栈的压入弹出序列
author: 熊滔
category: 剑指offer
---

> 输入两个整数序列，第一个序列表示栈的压入顺序，请判断第二个序列是否为该栈的弹出顺序。假设压入栈的所有数字均不相等。例如，序列 `{1, 2, 3, 4, 5}` 是某栈的压栈序列，序列 `{4, 5, 3, 2, 1}` 是该压栈序列对于的一个弹出序列，但是 `{4, 3, 5, 1, 2}` 就不可能是该压栈序列的弹出序列。

解决这个问题的办法使用一个辅助栈，我们根据上面的压入、弹出序列向栈中压入和弹出元素，方法如下：根据弹出序列需要弹出的元素，我们首先看栈顶元素是否是需要弹出的元素或者栈是否为空，如果栈为空或者栈顶元素不是需要弹出的元素，那么根据压入序列向栈中压入元素，直到压入了需要弹出的元素，停止压入。如果压入序列中的所有元素都已经压入栈中，都没有找到需要弹出的元素，那么说明这个弹出序列不是该栈的弹出序列

<img src="https://gitee.com/lastknightcoder/blogimage/raw/master/202006231521.svg"/>

代码如下：

```java
public static boolean isPopOrder(int[] pushOrder, int[] popOrder) {
    if (pushOrder == null || popOrder == null) {
        return false;
    }

    if (pushOrder.length != popOrder.length) {
        return false;
    }
    
    boolean possible = false;
    // pushIndex 表示压入序列中未压入栈的元素的起始下标
    int pushIndex = 0;
    // popIndex 表示弹出序列中未弹出的元素的起始下标
    int popIndex = 0;
    
    Stack<Integer> stack = new Stack<>();

    // 如果弹出序列还有元素未弹出
    while (popIndex < popOrder.length) {
        // 当栈为空时或者栈顶元素不为弹出的元素时，根据压入顺序压入元素
        while(stack.isEmpty() || stack.peek() != popOrder[popIndex]) {
            // 压入序列中的元素已全部压入
            if (pushIndex == pushOrder.length) {
                break;
            }
            stack.push(pushOrder[pushIndex++]);
        }
        
        // 如果栈顶元素不是弹出的元素，那么这个序列不是该栈的一个弹出序列
        if (stack.peek() != popOrder[popIndex]) {
            break;
        }
        // 如果栈顶是弹出元素，弹出此元素
        stack.pop();
        popIndex++;
    }

    if (stack.isEmpty() && popIndex == popOrder.length) {
        possible = true;
    }

    return possible;
}
```

<Disqus />