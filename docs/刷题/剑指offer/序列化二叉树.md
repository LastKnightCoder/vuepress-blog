---
title: 序列化二叉树
author: 熊滔
category: 剑指offer
---

> 题目：请实现两个函数，分别用来序列化和反序列化二叉树。

我们使用前序遍历来序列化树，当碰到 `null` 节点时，序列化为 `$`，如下

```java
public static void serialize(BinaryTreeNode root, StringBuilder stringBuilder) {
    if (root == null) {
        stringBuilder.append("$,");
        return;
    }
    stringBuilder.append(root.value + ",");
    serialize(root.left, stringBuilder);
    serialize(root.right, stringBuilder);
}
```

接着我们根据前序遍历序列化的字符串，反序列为一棵树。前序遍历的特点如下

<img src="https://gitee.com/lastknightcoder/blogimage/raw/master/202006282224.svg"/>


即第一个字符代表的是根节点，后面分为两部分，分别是它的左子树和右子树，对于任意一个字符，只要它不是 `$`，那么它后面跟的一定是它的左右子树

```java
private static int index;

public static BinaryTreeNode deserialize(StringBuilder stringBuilder) {
    // 转为字符串数组处理
    String[] str = stringBuilder.toString().split(",");
    BinaryTreeNode root = null;
    // index是全局变量，表示未序列化字符的起始下标
    index = 0;
    return deserialize(str, root);
}

private static BinaryTreeNode deserialize(String[] str, BinaryTreeNode root) {
    // 如果不是 $，就会有左右子树
    if (!str[index].equals("$")) {
        root = new BinaryTreeNode(new Integer(str[index++]));
        root.left = deserialize(str, root.left);
        root.right = deserialize(str, root.right);
    } else {
        // 如果是 $，root 默认是 null，只更新 index
        index++;
    }
    return root;
}
```

<Disqus />